# PanguPay 前端项目总览 (Project Overview)

## 1. 项目摘要
**PanguPay Transfer Interface** 是盘古系统（Pangu System）的官方 Web 端钱包应用。作为一个基于 **UTXO 模型** 的纯前端钱包，它不依赖中心化托管，而是直接在浏览器端实现密钥管理、交易构造、签名与状态同步。

本项目不仅仅是一个 UI 界面，它包含了一个完整的**轻量级客户端内核**，能够独立完成复杂的金融交互逻辑，是盘古生态中连接用户与区块链网络的核心门户。

---

## 2. 核心定位与目标
*   **去中心化交互**：通过 BootNode 动态发现服务节点，用户直接与网络交互，无中间商。
*   **多模式支持**：
    *   **散户模式**：无需加入组织，直接使用 UTXO 发起聚合交易。
    *   **担保组织模式**：加入组织后，享受更快的确认速度与更低的费率。
    *   **跨链模式**：支持与 ETH/BTC 生态的资产互通。
*   **极致安全（Client-Side Security）**：私钥仅在本地加密存储（PBKDF2 + AES-256-GCM），签名过程完全离线进行，敏感数据永不触网。

---

## 3. 统计数据与规模
*   **代码规模**: 约 40,000+ 行代码 (TypeScript/JavaScript/CSS)。
*   **模块数量**: 包含 17+ 核心业务服务 (Services)，30+ 工具库 (Utils)。
*   **页面视图**: 12+ 核心业务页面（包含主钱包、转账面板、历史记录、组织管理等）。

---

## 4. 技术栈选型与决策理由

| 技术领域 | 选型 | 决策理由 |
| :--- | :--- | :--- |
| **构建工具** | **Vite 5** | 秒级 HMR（热更新），构建产物极致压缩，原生支持 ESM，开发体验极佳。 |
| **开发语言** | **TypeScript** | 提供静态类型检查，显著降低金融类业务的运行时错误风险，提高重构安全性。 |
| **渲染引擎** | **Lit-HTML** | **安全与性能**：基于 tagged template literals，原生防止 XSS 注入；无 Virtual DOM 开销，直接操作 DOM，性能接近原生 JS。 |
| **密码学** | **Elliptic (P-256)** | **标准兼容**：选用 NIST P-256 曲线，严格对齐链底层签名标准；配合 `js-sha256` 进行哈希计算。 |
| **数值计算** | **BigInt-JSON** | **精度保障**：原生 JS `Number` 无法精确表示 64 位整数，使用 BigInt 确保资产金额与公钥坐标零误差。 |
| **样式体系** | **CSS Variables** | **灵活主题**：基于原生 CSS 变量实现深色/浅色模式切换，无预处理器依赖，轻量高效。 |
| **状态管理** | **Custom Store** | **轻量可控**：自研的发布-订阅模式 Store，针对性地实现了状态持久化与切片更新，避免引入 Redux 等库的冗余。 |

---

## 5. 架构设计原则 (Design Principles)

1.  **安全优先 (Security First)**：
    *   所有涉及私钥的操作必须在 `js/utils/keyEncryption.ts` 封闭环境内完成。
    *   输入必须经过 `js/utils/security.ts` 清洗，防止 XSS/注入攻击。

2.  **单一事实来源 (Single Source of Truth)**：
    *   应用状态统一由 `js/utils/store.js` 管理。
    *   页面路由统一由 `js/router.ts` 分发。

3.  **渐进式增强 (Progressive Enhancement)**：
    *   核心转账功能在弱网或由 Service Worker 缓存支持下仍可访问。
    *   UI 使用 `lit-html` 按需渲染，首屏加载速度极快。

4.  **松耦合模块 (Loose Coupling)**：
    *   页面（Pages）不直接调用 API，而是通过 服务（Services）层。
    *   服务层不直接操作 DOM，而是通过状态流驱动 UI 更新。

---

## 6. 质量保障体系
*   **类型安全**: `strict: true` 模式下的 TypeScript 编译检查。
*   **单元测试**: 针对利息计算、序列化逻辑的 Node.js 原生测试。
*   **自动化构建**: `npm run build` 自动进行 Tree Shaking 与代码压缩。
*   **规范化开发**: 统一的代码风格与 ESLint 规则。

---

## 7. 总结
PanguPay 前端项目是一个**工业级**的 Web3 钱包解决方案。它不仅仅是展示层，更是区块链逻辑的完整客户端实现。清晰的架构、严谨的安全设计以及高性能的技术选型，使其能够承载高频、高价值的金融交易场景。
